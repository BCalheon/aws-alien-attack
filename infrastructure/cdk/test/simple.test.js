"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("@aws-cdk/assert/jest");
const configLayer = require("./../lib/layer/configurationLayer");
const databaseLayer = require("./../lib/layer/databaseLayer");
const securityLayer = require("./../lib/layer/securityLayer");
const storageLayer = require("./../lib/layer/storageLayer");
const contentDeliveryLayer = require("./../lib/layer/contentDeliveryLayer");
const processingLayer = require("./../lib/layer/processingLayer");
const websocketLayer = require("./../lib/layer/websocketLayer");
const ingestionConsumptionLayer = require("./../lib/layer/ingestionConsumptionLayer");
const resourceawarestack_1 = require("./../lib/resourceawarestack");
const nrta_1 = require("./../lib/nrta");
// This is the helper class which instantiates the essential resources and then pass them to the testFunction
class AlienAttackTest {
    static test(testFunction) {
        if (!testFunction)
            throw new Error("Test function was not defined");
        const stack = new resourceawarestack_1.ResourceAwareStack();
        const props = new nrta_1.NRTAProps();
        props.region = process.env.region;
        props.accountId = process.env.account;
        props.setApplicationName('TEST');
        testFunction(stack, props);
    }
}
/**
 * SECURITY LAYER
 */
test('SecurityLayer validation', () => {
    let testFunction = function (stack, props) {
        new securityLayer.SecurityLayer(stack, 'SecurityLayer', props);
        let expectedResources = [
            'AWS::IAM::Role',
            'AWS::IAM::Policy',
            'AWS::Lambda::Function',
            'AWS::Cognito::UserPool',
            'AWS::Cognito::UserPoolClient',
            'AWS::Lambda::Permission',
            'AWS::Cognito::IdentityPool',
            'AWS::Cognito::UserPoolGroup',
            'AWS::Cognito::IdentityPoolRoleAttachment'
        ];
        expectedResources.forEach((resource) => {
            expect(stack).toHaveResource(resource);
        });
    };
    AlienAttackTest.test(testFunction);
});
/**
 * CONFIGURATION LAYER
 * This simple test validates the Config layer (where Systems Manager parameters are defined),
 * so checking if the Cloudformation Template is generated properly
 *
 */
test('ConfigurationLayer validation (Systems Manager Parameters)', () => {
    let testFunction = function (stack, props) {
        let ssmParameters = new Map();
        ssmParameters.set("parameter1", "value1");
        props.addParameter("ssmParameters", ssmParameters);
        new configLayer.ConfigurationLayer(stack, 'ConfigLayer', props);
        expect(stack).toHaveResource('AWS::SSM::Parameter');
    };
    AlienAttackTest.test(testFunction);
});
/**
 * STORAGE LAYER
 */
test('StorageLayer validation', () => {
    let testFunction = function (stack, props) {
        props.addParameter('existingbuckets', []);
        new storageLayer.StorageLayer(stack, 'StorageLayer', props);
        expect(stack).toHaveResource('AWS::S3::Bucket');
    };
    AlienAttackTest.test(testFunction);
});
/**
 * CONTENT DELIVERY LAYER
 */
test('ContentDeliveryLayer validation', () => {
    let testFunction = function (stack, props) {
        props.addParameter('appBucket', { bucketName: 'testappbucket' });
        props.addParameter('rawBucket', { bucketName: 'testrawbucket' });
        new contentDeliveryLayer.ContentDeliveryLayer(stack, 'ContentDeliveryLayer', props);
        expect(stack).toHaveResource('AWS::CloudFront::CloudFrontOriginAccessIdentity');
        expect(stack).toHaveResource('AWS::CloudFront::Distribution');
        expect(stack).toHaveResource('AWS::S3::BucketPolicy');
    };
    AlienAttackTest.test(testFunction);
});
/**
 * DATABASE LAYER
 */
test('DatabaseLayer validation', () => {
    let testFunction = function (stack, props) {
        new databaseLayer.DatabaseLayer(stack, 'DatabaseLayer', props);
        expect(stack).toHaveResource('AWS::DynamoDB::Table');
    };
    AlienAttackTest.test(testFunction);
});
/**
 * PROCESSING LAYER
 */
test('ProcessingLayer validation', () => {
    let testFunction = function (stack, props) {
        props.addParameter('table.sessioncontrol', 'TBLSESSIONCONTROL');
        props.addParameter('table.sessionTopX', 'TBLSESSIONTOP');
        props.addParameter('table.session', 'TBLSESSION');
        new processingLayer.ProcessingLayer(stack, 'ProcessingLayer', props);
        let expectedResources = [
            'AWS::IAM::Role',
            'AWS::Lambda::Function',
            'AWS::SQS::Queue'
        ];
        expectedResources.forEach((resource) => {
            expect(stack).toHaveResource(resource);
        });
    };
    AlienAttackTest.test(testFunction);
});
/**
 * WEBSOCKET LAYER
 */
test('WebsocketLayer validation', () => {
    let testFunction = function (stack, props) {
        props.addParameter('table.sessioncontrol', 'TBL_TEST_SESSIONCONTROL');
        new websocketLayer.WebSocketLayer(stack, 'WebSocketLayer', props);
        expect(stack).toHaveResource('AWS::Lambda::Function');
        expect(stack).toHaveResource('AWS::IAM::Role');
    };
    AlienAttackTest.test(testFunction);
});
/**
 * INGESTION-CONSUMPTION LAYER
 */
test('IngestionConsumptionLayer validation', () => {
    let testFunction = function (stack, props) {
        props.addParameter('kinesisintegration', true);
        props.addParameter('firehose', true);
        let secl = new securityLayer.SecurityLayer(stack, 'SecurityLayer', props);
        props.addParameter('existingbuckets', []);
        let stol = new storageLayer.StorageLayer(stack, 'StorageLayer', props);
        props.addParameter('rawbucketarn', stol.getRawDataBucketArn());
        let dbl = new databaseLayer.DatabaseLayer(stack, 'DatabaseLayer', props);
        props.addParameter('table.sessionTopX', dbl.getResource('table.sessiontopx'));
        props.addParameter('table.session', dbl.getResource('table.session'));
        props.addParameter('table.sessionControl', dbl.getResource('table.sessioncontrol'));
        let pl = new processingLayer.ProcessingLayer(stack, 'ProcessingLayer', props);
        props.addParameter('rawbucketarn', stol.getRawDataBucketArn());
        props.addParameter('userpool', secl.getUserPoolArn());
        props.addParameter('userpoolid', secl.getUserPoolId());
        props.addParameter('table.session', dbl.getResource('table.session'));
        props.addParameter('table.sessiontopx', dbl.getResource('table.sessiontopx'));
        props.addParameter('lambda.allocate', pl.getAllocateFunctionRef());
        props.addParameter('lambda.deallocate', pl.getDeallocateFunctionArn());
        props.addParameter('lambda.scoreboard', pl.getScoreboardFunctionRef());
        props.addParameter('security.playersrole', secl.getResource('security.playersrole'));
        props.addParameter('security.managersrole', secl.getResource('security.managersrole'));
        new ingestionConsumptionLayer.IngestionConsumptionLayer(stack, 'IngestionConsumptionLayer', props);
        let expectedResources = [
            'AWS::Kinesis::Stream',
            'AWS::KinesisFirehose::DeliveryStream',
            'AWS::IAM::Role',
            'AWS::ApiGateway::RestApi',
            'AWS::ApiGateway::GatewayResponse',
            'AWS::ApiGateway::Authorizer',
            'AWS::ApiGateway::Model',
            'AWS::ApiGateway::Resource',
            'AWS::ApiGateway::Method',
            'AWS::ApiGateway::Deployment'
        ];
        expectedResources.forEach((resource) => {
            expect(stack).toHaveResource(resource);
        });
    };
    AlienAttackTest.test(testFunction);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzaW1wbGUudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGdDQUE4QjtBQUM5QixpRUFBaUU7QUFDakUsOERBQThEO0FBQzlELDhEQUE4RDtBQUM5RCw0REFBNEQ7QUFDNUQsNEVBQTRFO0FBQzVFLGtFQUFrRTtBQUNsRSxnRUFBZ0U7QUFDaEUsc0ZBQXNGO0FBQ3RGLG9FQUFpRTtBQUNqRSx3Q0FBMEM7QUFjekMsNkdBQTZHO0FBQzdHLE1BQU0sZUFBZTtJQUNsQixNQUFNLENBQUMsSUFBSSxDQUFDLFlBQTBCO1FBQ2xDLElBQUksQ0FBQyxZQUFZO1lBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sS0FBSyxHQUFHLElBQUksdUNBQWtCLEVBQUUsQ0FBQztRQUN2QyxNQUFNLEtBQUssR0FBRyxJQUFJLGdCQUFTLEVBQUUsQ0FBQztRQUM5QixLQUFLLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO1FBQ2xDLEtBQUssQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUM7UUFDdEMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2pDLFlBQVksQ0FBQyxLQUFLLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztDQUNMO0FBRUQ7O0dBRUc7QUFDSCxJQUFJLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxFQUFFO0lBQ2xDLElBQUksWUFBWSxHQUFHLFVBQVMsS0FBMEIsRUFBRSxLQUFnQjtRQUNwRSxJQUFJLGFBQWEsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMvRCxJQUFJLGlCQUFpQixHQUFHO1lBQ3BCLGdCQUFnQjtZQUNoQixrQkFBa0I7WUFDbEIsdUJBQXVCO1lBQ3ZCLHdCQUF3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QUFDLENBQUMsQ0FBQztRQUN2RixJQUFJLHlCQUF5QixDQUFDLHlCQUF5QixDQUFDLEtBQUssRUFBRSwyQkFBMkIsRUFBQyxLQUFLLENBQUMsQ0FBQztRQUVsRyxJQUFJLGlCQUFpQixHQUFHO1lBQ3BCLHNCQUFzQjtZQUN0QixzQ0FBc0M7WUFDdEMsZ0JBQWdCO1lBQ2hCLDBCQUEwQjtZQUMxQixrQ0FBa0M7WUFDbEMsNkJBQTZCO1lBQzdCLHdCQUF3QjtZQUN4QiwyQkFBMkI7WUFDM0IseUJBQXlCO1lBQ3pCLDZCQUE2QjtTQUNoQyxDQUFDO1FBQ0YsaUJBQWlCLENBQUMsT0FBTyxDQUFFLENBQUMsUUFBUSxFQUFFLEVBQUU7WUFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQztJQUNGLGVBQWUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdkMsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ0Bhd3MtY2RrL2Fzc2VydC9qZXN0JztcbmltcG9ydCAqIGFzIGNvbmZpZ0xheWVyIGZyb20gJy4vLi4vbGliL2xheWVyL2NvbmZpZ3VyYXRpb25MYXllcic7XG5pbXBvcnQgKiBhcyBkYXRhYmFzZUxheWVyIGZyb20gJy4vLi4vbGliL2xheWVyL2RhdGFiYXNlTGF5ZXInO1xuaW1wb3J0ICogYXMgc2VjdXJpdHlMYXllciBmcm9tICcuLy4uL2xpYi9sYXllci9zZWN1cml0eUxheWVyJztcbmltcG9ydCAqIGFzIHN0b3JhZ2VMYXllciBmcm9tICcuLy4uL2xpYi9sYXllci9zdG9yYWdlTGF5ZXInO1xuaW1wb3J0ICogYXMgY29udGVudERlbGl2ZXJ5TGF5ZXIgZnJvbSAnLi8uLi9saWIvbGF5ZXIvY29udGVudERlbGl2ZXJ5TGF5ZXInO1xuaW1wb3J0ICogYXMgcHJvY2Vzc2luZ0xheWVyIGZyb20gJy4vLi4vbGliL2xheWVyL3Byb2Nlc3NpbmdMYXllcic7XG5pbXBvcnQgKiBhcyB3ZWJzb2NrZXRMYXllciBmcm9tICcuLy4uL2xpYi9sYXllci93ZWJzb2NrZXRMYXllcic7XG5pbXBvcnQgKiBhcyBpbmdlc3Rpb25Db25zdW1wdGlvbkxheWVyIGZyb20gJy4vLi4vbGliL2xheWVyL2luZ2VzdGlvbkNvbnN1bXB0aW9uTGF5ZXInO1xuaW1wb3J0IHsgUmVzb3VyY2VBd2FyZVN0YWNrIH0gZnJvbSAnLi8uLi9saWIvcmVzb3VyY2Vhd2FyZXN0YWNrJztcbmltcG9ydCB7IE5SVEFQcm9wcyB9IGZyb20gJy4vLi4vbGliL25ydGEnO1xuXG4vKipcbiAqIFRoZXNlIHRlc3RzIGFyZSBidWlsdCB1c2luZyBodHRwczovL2plc3Rqcy5pby9cbiAqIFxuICogVG8gcHJlcGFyZSB0aGUgZW52aXJvbWVudCwgeW91IG5lZWQgdG86XG4gKiBucG0gaW5zdGFsbCAtLXNhdmUtZGV2IGplc3QgQHR5cGVzL2plc3QgQGF3cy1jZGsvYXNzZXJ0XG4gKi9cbiBcbiAvLyBUaGlzIGludGVyZmFjZSBzcGVjaWZpZXMgdGhlIHRlc3QgZnVuY3Rpb24gdGhhdCB3ZSBuZWVkIHRvIGhhdmUgaW4gcGxhY2UgdG8gdGVzdCBBbGllbiBBdHRhY2sgc3RhY2tzXG4gaW50ZXJmYWNlIFRlc3RGdW5jdGlvbiB7XG4gICAgIChzdGFjayA6IFJlc291cmNlQXdhcmVTdGFjaywgcHJvcHM6IE5SVEFQcm9wcykgOiB2b2lkO1xuIH0gXG4gXG4gLy8gVGhpcyBpcyB0aGUgaGVscGVyIGNsYXNzIHdoaWNoIGluc3RhbnRpYXRlcyB0aGUgZXNzZW50aWFsIHJlc291cmNlcyBhbmQgdGhlbiBwYXNzIHRoZW0gdG8gdGhlIHRlc3RGdW5jdGlvblxuIGNsYXNzIEFsaWVuQXR0YWNrVGVzdCB7XG4gICAgc3RhdGljIHRlc3QodGVzdEZ1bmN0aW9uOiBUZXN0RnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKCF0ZXN0RnVuY3Rpb24pIHRocm93IG5ldyBFcnJvcihcIlRlc3QgZnVuY3Rpb24gd2FzIG5vdCBkZWZpbmVkXCIpO1xuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBSZXNvdXJjZUF3YXJlU3RhY2soKTtcbiAgICAgICAgY29uc3QgcHJvcHMgPSBuZXcgTlJUQVByb3BzKCk7XG4gICAgICAgIHByb3BzLnJlZ2lvbiA9IHByb2Nlc3MuZW52LnJlZ2lvbjtcbiAgICAgICAgcHJvcHMuYWNjb3VudElkID0gcHJvY2Vzcy5lbnYuYWNjb3VudDtcbiAgICAgICAgcHJvcHMuc2V0QXBwbGljYXRpb25OYW1lKCdURVNUJyk7XG4gICAgICAgIHRlc3RGdW5jdGlvbihzdGFjayxwcm9wcyk7XG4gICAgIH0gIFxufVxuIFxuLyoqXG4gKiBTRUNVUklUWSBMQVlFUlxuICovXG50ZXN0KCdTZWN1cml0eUxheWVyIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKHN0YWNrIDogUmVzb3VyY2VBd2FyZVN0YWNrLCBwcm9wczogTlJUQVByb3BzKSB7XG4gICAgICAgIG5ldyBzZWN1cml0eUxheWVyLlNlY3VyaXR5TGF5ZXIoc3RhY2ssICdTZWN1cml0eUxheWVyJywgcHJvcHMpO1xuICAgICAgICBsZXQgZXhwZWN0ZWRSZXNvdXJjZXMgPSBbXG4gICAgICAgICAgICAnQVdTOjpJQU06OlJvbGUnLFxuICAgICAgICAgICAgJ0FXUzo6SUFNOjpQb2xpY3knLFxuICAgICAgICAgICAgJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsXG4gICAgICAgICAgICAnQVdTOjpDb2duaXRvOjpVc2VyUG9vbCcsXG4gICAgICAgICAgICAnQVdTOjpDb2duaXRvOjpVc2VyUG9vbENsaWVudCcsXG4gICAgICAgICAgICAnQVdTOjpMYW1iZGE6OlBlcm1pc3Npb24nLFxuICAgICAgICAgICAgJ0FXUzo6Q29nbml0bzo6SWRlbnRpdHlQb29sJyxcbiAgICAgICAgICAgICdBV1M6OkNvZ25pdG86OlVzZXJQb29sR3JvdXAnLFxuICAgICAgICAgICAgJ0FXUzo6Q29nbml0bzo6SWRlbnRpdHlQb29sUm9sZUF0dGFjaG1lbnQnXG4gICAgICAgIF07XG4gICAgICAgIGV4cGVjdGVkUmVzb3VyY2VzLmZvckVhY2goIChyZXNvdXJjZSkgPT4ge1xuICAgICAgICAgICAgZXhwZWN0KHN0YWNrKS50b0hhdmVSZXNvdXJjZShyZXNvdXJjZSk7XG4gICAgICAgIH0pXG4gICAgfTtcbiAgICBBbGllbkF0dGFja1Rlc3QudGVzdCh0ZXN0RnVuY3Rpb24pO1xufSlcblxuXG4vKipcbiAqIENPTkZJR1VSQVRJT04gTEFZRVJcbiAqIFRoaXMgc2ltcGxlIHRlc3QgdmFsaWRhdGVzIHRoZSBDb25maWcgbGF5ZXIgKHdoZXJlIFN5c3RlbXMgTWFuYWdlciBwYXJhbWV0ZXJzIGFyZSBkZWZpbmVkKSxcbiAqIHNvIGNoZWNraW5nIGlmIHRoZSBDbG91ZGZvcm1hdGlvbiBUZW1wbGF0ZSBpcyBnZW5lcmF0ZWQgcHJvcGVybHlcbiAqIFxuICovXG50ZXN0KCdDb25maWd1cmF0aW9uTGF5ZXIgdmFsaWRhdGlvbiAoU3lzdGVtcyBNYW5hZ2VyIFBhcmFtZXRlcnMpJywgKCkgPT4ge1xuICAgIGxldCB0ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbihzdGFjayA6IFJlc291cmNlQXdhcmVTdGFjaywgcHJvcHM6IE5SVEFQcm9wcykge1xuICAgICAgICBsZXQgc3NtUGFyYW1ldGVycyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG4gICAgICAgIHNzbVBhcmFtZXRlcnMuc2V0KFwicGFyYW1ldGVyMVwiLCBcInZhbHVlMVwiKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKFwic3NtUGFyYW1ldGVyc1wiLHNzbVBhcmFtZXRlcnMpO1xuICAgICAgICBuZXcgY29uZmlnTGF5ZXIuQ29uZmlndXJhdGlvbkxheWVyKHN0YWNrLCdDb25maWdMYXllcicscHJvcHMpO1xuICAgICAgICBleHBlY3Qoc3RhY2spLnRvSGF2ZVJlc291cmNlKCdBV1M6OlNTTTo6UGFyYW1ldGVyJyk7XG4gICAgfTtcbiAgICBBbGllbkF0dGFja1Rlc3QudGVzdCh0ZXN0RnVuY3Rpb24pO1xufSk7XG5cbi8qKlxuICogU1RPUkFHRSBMQVlFUlxuICovIFxudGVzdCgnU3RvcmFnZUxheWVyIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKHN0YWNrIDogUmVzb3VyY2VBd2FyZVN0YWNrLCBwcm9wczogTlJUQVByb3BzKSB7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcignZXhpc3RpbmdidWNrZXRzJyxbXSk7XG4gICAgICAgIG5ldyBzdG9yYWdlTGF5ZXIuU3RvcmFnZUxheWVyKHN0YWNrLCAnU3RvcmFnZUxheWVyJywgcHJvcHMpO1xuICAgICAgICBleHBlY3Qoc3RhY2spLnRvSGF2ZVJlc291cmNlKCdBV1M6OlMzOjpCdWNrZXQnKTtcbiAgICB9O1xuICAgIEFsaWVuQXR0YWNrVGVzdC50ZXN0KHRlc3RGdW5jdGlvbik7XG59KTtcblxuXG4vKipcbiAqIENPTlRFTlQgREVMSVZFUlkgTEFZRVJcbiAqLyBcbnRlc3QoJ0NvbnRlbnREZWxpdmVyeUxheWVyIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKHN0YWNrIDogUmVzb3VyY2VBd2FyZVN0YWNrLCBwcm9wczogTlJUQVByb3BzKSB7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcignYXBwQnVja2V0JywgeyBidWNrZXROYW1lIDogJ3Rlc3RhcHBidWNrZXQnIH0gKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCdyYXdCdWNrZXQnLCB7IGJ1Y2tldE5hbWUgOiAndGVzdHJhd2J1Y2tldCcgfSApO1xuICAgICAgICBuZXcgY29udGVudERlbGl2ZXJ5TGF5ZXIuQ29udGVudERlbGl2ZXJ5TGF5ZXIoc3RhY2ssICdDb250ZW50RGVsaXZlcnlMYXllcicsIHByb3BzKTtcbiAgICAgICAgZXhwZWN0KHN0YWNrKS50b0hhdmVSZXNvdXJjZSgnQVdTOjpDbG91ZEZyb250OjpDbG91ZEZyb250T3JpZ2luQWNjZXNzSWRlbnRpdHknKTtcbiAgICAgICAgZXhwZWN0KHN0YWNrKS50b0hhdmVSZXNvdXJjZSgnQVdTOjpDbG91ZEZyb250OjpEaXN0cmlidXRpb24nKTtcbiAgICAgICAgZXhwZWN0KHN0YWNrKS50b0hhdmVSZXNvdXJjZSgnQVdTOjpTMzo6QnVja2V0UG9saWN5Jyk7XG4gICAgfTtcbiAgICBBbGllbkF0dGFja1Rlc3QudGVzdCh0ZXN0RnVuY3Rpb24pO1xufSk7XG5cblxuLyoqXG4gKiBEQVRBQkFTRSBMQVlFUlxuICovIFxudGVzdCgnRGF0YWJhc2VMYXllciB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGxldCB0ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbihzdGFjayA6IFJlc291cmNlQXdhcmVTdGFjaywgcHJvcHM6IE5SVEFQcm9wcykge1xuICAgICAgICBuZXcgZGF0YWJhc2VMYXllci5EYXRhYmFzZUxheWVyKHN0YWNrLCAnRGF0YWJhc2VMYXllcicsIHByb3BzKTtcbiAgICAgICAgZXhwZWN0KHN0YWNrKS50b0hhdmVSZXNvdXJjZSgnQVdTOjpEeW5hbW9EQjo6VGFibGUnKTtcbiAgICB9O1xuICAgIEFsaWVuQXR0YWNrVGVzdC50ZXN0KHRlc3RGdW5jdGlvbik7XG59KTtcblxuXG4vKipcbiAqIFBST0NFU1NJTkcgTEFZRVJcbiAqLyBcbnRlc3QoJ1Byb2Nlc3NpbmdMYXllciB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGxldCB0ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbihzdGFjayA6IFJlc291cmNlQXdhcmVTdGFjaywgcHJvcHM6IE5SVEFQcm9wcykge1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3RhYmxlLnNlc3Npb25jb250cm9sJywnVEJMU0VTU0lPTkNPTlRST0wnKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCd0YWJsZS5zZXNzaW9uVG9wWCcsJ1RCTFNFU1NJT05UT1AnKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCd0YWJsZS5zZXNzaW9uJywnVEJMU0VTU0lPTicpO1xuICAgICAgICBuZXcgcHJvY2Vzc2luZ0xheWVyLlByb2Nlc3NpbmdMYXllcihzdGFjaywgJ1Byb2Nlc3NpbmdMYXllcicsIHByb3BzKTtcbiAgICAgICAgbGV0IGV4cGVjdGVkUmVzb3VyY2VzID0gW1xuICAgICAgICAgICAgJ0FXUzo6SUFNOjpSb2xlJyxcbiAgICAgICAgICAgICdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLFxuICAgICAgICAgICAgJ0FXUzo6U1FTOjpRdWV1ZSdcbiAgICAgICAgXTtcbiAgICAgICAgZXhwZWN0ZWRSZXNvdXJjZXMuZm9yRWFjaCggKHJlc291cmNlKSA9PiB7XG4gICAgICAgICAgICBleHBlY3Qoc3RhY2spLnRvSGF2ZVJlc291cmNlKHJlc291cmNlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBbGllbkF0dGFja1Rlc3QudGVzdCh0ZXN0RnVuY3Rpb24pO1xufSk7XG5cbi8qKlxuICogV0VCU09DS0VUIExBWUVSXG4gKi8gXG50ZXN0KCdXZWJzb2NrZXRMYXllciB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGxldCB0ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbihzdGFjayA6IFJlc291cmNlQXdhcmVTdGFjaywgcHJvcHM6IE5SVEFQcm9wcykge1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3RhYmxlLnNlc3Npb25jb250cm9sJywnVEJMX1RFU1RfU0VTU0lPTkNPTlRST0wnKTtcbiAgICAgICAgbmV3IHdlYnNvY2tldExheWVyLldlYlNvY2tldExheWVyKHN0YWNrLCAnV2ViU29ja2V0TGF5ZXInLCBwcm9wcyk7XG4gICAgICAgIGV4cGVjdChzdGFjaykudG9IYXZlUmVzb3VyY2UoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicpO1xuICAgICAgICBleHBlY3Qoc3RhY2spLnRvSGF2ZVJlc291cmNlKCdBV1M6OklBTTo6Um9sZScpO1xuICAgIH07XG4gICAgQWxpZW5BdHRhY2tUZXN0LnRlc3QodGVzdEZ1bmN0aW9uKTtcbn0pO1xuXG5cbi8qKlxuICogSU5HRVNUSU9OLUNPTlNVTVBUSU9OIExBWUVSXG4gKi8gXG50ZXN0KCdJbmdlc3Rpb25Db25zdW1wdGlvbkxheWVyIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKHN0YWNrIDogUmVzb3VyY2VBd2FyZVN0YWNrLCBwcm9wczogTlJUQVByb3BzKSB7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcigna2luZXNpc2ludGVncmF0aW9uJywgdHJ1ZSk7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcignZmlyZWhvc2UnLHRydWUpO1xuICAgICAgICBsZXQgc2VjbCA9IG5ldyBzZWN1cml0eUxheWVyLlNlY3VyaXR5TGF5ZXIoc3RhY2ssICdTZWN1cml0eUxheWVyJywgcHJvcHMpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ2V4aXN0aW5nYnVja2V0cycsW10pO1xuICAgICAgICBsZXQgc3RvbCA9IG5ldyBzdG9yYWdlTGF5ZXIuU3RvcmFnZUxheWVyKHN0YWNrLCAnU3RvcmFnZUxheWVyJywgcHJvcHMpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3Jhd2J1Y2tldGFybicsc3RvbC5nZXRSYXdEYXRhQnVja2V0QXJuKCkpO1xuICAgICAgICBsZXQgZGJsID0gIG5ldyBkYXRhYmFzZUxheWVyLkRhdGFiYXNlTGF5ZXIoc3RhY2ssICdEYXRhYmFzZUxheWVyJywgcHJvcHMpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3RhYmxlLnNlc3Npb25Ub3BYJyxkYmwuZ2V0UmVzb3VyY2UoJ3RhYmxlLnNlc3Npb250b3B4JykpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3RhYmxlLnNlc3Npb24nLGRibC5nZXRSZXNvdXJjZSgndGFibGUuc2Vzc2lvbicpKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCd0YWJsZS5zZXNzaW9uQ29udHJvbCcsZGJsLmdldFJlc291cmNlKCd0YWJsZS5zZXNzaW9uY29udHJvbCcpKTtcbiAgICAgICAgbGV0IHBsID0gbmV3IHByb2Nlc3NpbmdMYXllci5Qcm9jZXNzaW5nTGF5ZXIoc3RhY2ssICdQcm9jZXNzaW5nTGF5ZXInLCBwcm9wcyk7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcigncmF3YnVja2V0YXJuJywgc3RvbC5nZXRSYXdEYXRhQnVja2V0QXJuKCkpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3VzZXJwb29sJyxzZWNsLmdldFVzZXJQb29sQXJuKCkpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3VzZXJwb29saWQnLCBzZWNsLmdldFVzZXJQb29sSWQoKSk7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcigndGFibGUuc2Vzc2lvbicsZGJsLmdldFJlc291cmNlKCd0YWJsZS5zZXNzaW9uJykpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ3RhYmxlLnNlc3Npb250b3B4JyxkYmwuZ2V0UmVzb3VyY2UoJ3RhYmxlLnNlc3Npb250b3B4JykpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ2xhbWJkYS5hbGxvY2F0ZScscGwuZ2V0QWxsb2NhdGVGdW5jdGlvblJlZigpKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCdsYW1iZGEuZGVhbGxvY2F0ZScscGwuZ2V0RGVhbGxvY2F0ZUZ1bmN0aW9uQXJuKCkpO1xuICAgICAgICBwcm9wcy5hZGRQYXJhbWV0ZXIoJ2xhbWJkYS5zY29yZWJvYXJkJyxwbC5nZXRTY29yZWJvYXJkRnVuY3Rpb25SZWYoKSk7XG4gICAgICAgIHByb3BzLmFkZFBhcmFtZXRlcignc2VjdXJpdHkucGxheWVyc3JvbGUnLCBzZWNsLmdldFJlc291cmNlKCdzZWN1cml0eS5wbGF5ZXJzcm9sZScpKTtcbiAgICAgICAgcHJvcHMuYWRkUGFyYW1ldGVyKCdzZWN1cml0eS5tYW5hZ2Vyc3JvbGUnLCBzZWNsLmdldFJlc291cmNlKCdzZWN1cml0eS5tYW5hZ2Vyc3JvbGUnKSk7XG4gICAgICAgIG5ldyBpbmdlc3Rpb25Db25zdW1wdGlvbkxheWVyLkluZ2VzdGlvbkNvbnN1bXB0aW9uTGF5ZXIoc3RhY2ssICdJbmdlc3Rpb25Db25zdW1wdGlvbkxheWVyJyxwcm9wcyk7IFxuXG4gICAgICAgIGxldCBleHBlY3RlZFJlc291cmNlcyA9IFtcbiAgICAgICAgICAgICdBV1M6OktpbmVzaXM6OlN0cmVhbScsXG4gICAgICAgICAgICAnQVdTOjpLaW5lc2lzRmlyZWhvc2U6OkRlbGl2ZXJ5U3RyZWFtJyxcbiAgICAgICAgICAgICdBV1M6OklBTTo6Um9sZScsXG4gICAgICAgICAgICAnQVdTOjpBcGlHYXRld2F5OjpSZXN0QXBpJyxcbiAgICAgICAgICAgICdBV1M6OkFwaUdhdGV3YXk6OkdhdGV3YXlSZXNwb25zZScsXG4gICAgICAgICAgICAnQVdTOjpBcGlHYXRld2F5OjpBdXRob3JpemVyJyxcbiAgICAgICAgICAgICdBV1M6OkFwaUdhdGV3YXk6Ok1vZGVsJyxcbiAgICAgICAgICAgICdBV1M6OkFwaUdhdGV3YXk6OlJlc291cmNlJyxcbiAgICAgICAgICAgICdBV1M6OkFwaUdhdGV3YXk6Ok1ldGhvZCcsXG4gICAgICAgICAgICAnQVdTOjpBcGlHYXRld2F5OjpEZXBsb3ltZW50J1xuICAgICAgICBdO1xuICAgICAgICBleHBlY3RlZFJlc291cmNlcy5mb3JFYWNoKCAocmVzb3VyY2UpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdChzdGFjaykudG9IYXZlUmVzb3VyY2UocmVzb3VyY2UpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFsaWVuQXR0YWNrVGVzdC50ZXN0KHRlc3RGdW5jdGlvbik7XG59KTsiXX0=